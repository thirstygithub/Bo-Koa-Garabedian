<!DOCTYPE html>
<html lang="en-us">
  <head>
        <base href="https://cdn.jsdelivr.net/gh/genizy/biologyexams@main/nubbys-number-factory/">
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
    <title>GXC Game</title>
    <style>
      @-webkit-keyframes rotation {
        from {
          -webkit-transform: rotate(0deg);
        }

        to {
          -webkit-transform: rotate(360deg);
        }
      }

      @-moz-keyframes rotation {
        from {
          -moz-transform: rotate(0deg);
        }

        to {
          -moz-transform: rotate(360deg);
        }
      }

      @-o-keyframes rotation {
        from {
          -o-transform: rotate(0deg);
        }

        to {
          -o-transform: rotate(360deg);
        }
      }

      @keyframes rotation {
        from {
          transform: rotate(0deg);
        }

        to {
          transform: rotate(360deg);
        }
      }

      html {
        background: #060612;
      }

      body {
        font-family: arial;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        min-height: fill-available;
        min-height: 100svh; /* Otherwise contents can be covered by an address bar in Safari on iOS 15 */
        min-width: 100vw;
        background: radial-gradient(
          56.63% 56.63% at 50% 43.37%,
          #1c1726 0%,
          #060612 100%
        );
        display: flex;
        flex-direction: column;
        overflow-x: hidden;
        place-items: center;
      }

      body.scrollingDisabled {
        overflow: hidden;
      }

      .emscripten {
        padding-right: 0;
        display: block;
      }

      div.emscripten {
        text-align: center;
      }

      /* the canvas *must not* have any border or padding, or mouse coords will be wrong */
      canvas.emscripten {
        display: none;
        border: 0px none;
        background-color: black;
        position: relative;
        transition: opacity 5s ease-in;
        -webkit-transition: opacity 5s ease-in;
        opacity: 0;
        filter: blur(0) grayscale(0);
        margin-top: auto;
        margin-bottom: auto;
        image-rendering: optimizeSpeed;             /* Older versions of FF          */
        image-rendering: -moz-crisp-edges;          /* FF 6.0+                       */
        image-rendering: -webkit-optimize-contrast; /* Safari                        */
        image-rendering: -o-crisp-edges;            /* OS X & Windows Opera (12.02+) */
        image-rendering: pixelated;                 /* Awesome future-browsers       */
        -ms-interpolation-mode: nearest-neighbor;   /* IE                            */
      }

      canvas.active {
        animation-name: fadeIn;
        animation-duration: 2s;
        opacity: 1;
      }

      canvas.paused {
        animation-name: blur;
        animation-duration: 0.5s;
        filter: blur(2px) grayscale(1);
      }

      canvas.unpaused {
        animation-name: none;
      }

      canvas.animatedSizeTransitions {
        transition: width 0.3s ease, height 0.3s ease;
      }

      @keyframes fadeIn {
        0% {
          opacity: 0;
        }

        100% {
          opacity: 1;
        }
      }

      @keyframes blur {
        0% {
          filter: blur(0) grayscale(0);
        }

        100% {
          filter: blur(2px) grayscale(1);
        }
      }

      .spinner {
        height: 30px;
        width: 30px;

        -webkit-animation: rotation 0.8s linear infinite;
        -moz-animation: rotation 0.8s linear infinite;
        -o-animation: rotation 0.8s linear infinite;
        animation: rotation 0.8s linear infinite;

        border: 5px solid #bdff00;
        border-top: 5px solid #719900;
        border-radius: 100%;
      }

      .floating-control {
        position: absolute;
        display: none;
        border: none;

        left: 0px;
        top: 0px;
        width: 400px;
        height: 100%;
        padding: 10px;

        font-family: monospace;
        font-size: 8;
        color: white;
        background: rgba(53, 18, 84, 0.8);
        box-shadow: rgb(9 8 13 / 20%) -2px 2px 4px, rgb(9 8 13 / 40%) -4px 4px 16px;
      }

      #status {
        display: inline-block;
        vertical-align: top;
        font-weight: bold;
        color: white;
      }

      #progress {
        width: 250px;
        height: 10px;
        -webkit-appearance: none;
        appearance: none;
        padding: 5px;
      }

      /* Determines the style of the background of the progress bar */
      progress[value]::-webkit-progress-bar {
        background-color: #8492a6;
        height: 10px;
        border-radius: 15px;
      }
      /* Determines the style of the completed part of the progress bar */
      progress[value]::-webkit-progress-value {
        background-image: -webkit-linear-gradient(left, #719900, #bdff00);
        height: 10px;
        border-radius: 15px;
      }

      div.loading {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        pointer-events: none;
      }
      div.loading > * {
        padding: 10px;
        margin: 10px;
      }

      .output-container {
        text-align: center;
        margin-top: auto;
      }
      .output-button {
        border: none;
        width: 200px;
        height: 25px;
        margin: 5px;
        border-radius: 5px;
        cursor: pointer;
        background-color: black;
        color: #20c20e;
        font-family: "Lucida Console", Monaco, monospace;
      }

      #output {
        display: none;
        height: 200px;
        background-color: black;
        color: white;
        font-family: "Lucida Console", Monaco, monospace;
        outline: none;
        border: none;
        padding: 0;
        width: 100%;
      }

      #message-container {
        display: none;
        min-height: 50px;
        background-color: rgba(20, 20, 20, 0.5);
        outline: none;
        border: none;
        padding: 0;
        width: 100%;
        position: absolute;
        top: 0;
      }

      #messages {
        margin-left: 50px;
        color: white;
        font-family: "Lucida Console", Monaco, monospace;
        outline: none;
        border: none;
        padding: 0;
      }

      img.qrCode {
         opacity: 1.0;
         width: 50%;
         height: 50%;
      }

      #pauseMenuContainer {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #pauseMenuContainer[hidden] {
        display: none !important;
        opacity: 0;
      }

      #pauseMenuBorder {
        background: linear-gradient(135deg, #FA1E4E, transparent 40%);
        padding: 1px;
        border-radius: 4px;
        clip-path: polygon(10.5px 0, 100% 0, 100% 100%, 0 100%, 0 10.5px);
        width: 70vw;
        max-width: 400px;
      }

      #pauseMenu {
        display: flex;
        flex-direction: column;
        padding: 60px 30px 60px 30px;
        background: linear-gradient(180deg, #2E273F 16.15%, rgba(46, 39, 63, 0.79) 56.25%, #2E273F 91.15%);
        border-radius: 4px;
        clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%, 0 10px);
        animation-name: fadeIn;
        animation-duration: 0.5s;
        opacity: 1;
      }

      #pauseMenu button {
        font-weight: 500;
        font-size: 17px;
        color: white;
        background: #FA1E4E;
        border: 1px solid #FA1E4E;
        border-radius: 6px;
        padding: 12px 24px;
        margin: 5px 0;
        -webkit-user-select: none;
        user-select: none;
      }

      #pauseMenu button#quitButton {
        background: #FA1E4E40;
      }

      #pauseMenu button:hover {
        filter: brightness(1.15);
      }

      #pauseMenu button:active {
        filter: brightness(0.85);
      }

      #pauseMenu button[hidden] {
        display: none;
      }

      .graph .labels.x-labels {
        background-color: white;
        text-anchor: middle;
      }

      .graph .labels.y-labels {
        text-anchor: end;
      }

      .graph {
        font-family: Averta, -apple-system, "Segoe UI", system-ui, sans-serif;
        font-feature-settings: "tnum", "lnum";
        font-style: normal;
        font-size: 14px;
        font-weight: 600;
        line-height: 21px;
        text-decoration-line: none;
        letter-spacing: 0.25px;
        background-color: transparent;
        fill: #ccc;
      }

      .graph .grid {
        stroke: #ccc;
        stroke-dasharray: 0;
        stroke-width: 1;
      }

      .labels {
        font-size: 4px;
      }

      .label-title {
        font-weight: bold;
        text-transform: uppercase;
        font-size: 4px;
      }

      .peer0 {
        fill: #fa1f4e;
        stroke: #fa1f4e;
      }
      .peer1 {
        fill: #a970ff;
        stroke: #a970ff;
      }
      .peer2 {
        fill: #4574ee;
        stroke: #4574ee;
      }
      .peer3 {
        fill: #c3ff6f;
        stroke: #c3ff6f;
      }

      .peer {
        stroke-width: 0;
      }

      .peer-frame-delay {
        fill: none;
        stroke-width: 1;
      }

      .acceptable-rollback-button {
        border: none;
        width: 50px;
        height: 25px;
        margin: 5px;
        border-radius: 5px;
        cursor: pointer;
        background-color: black;
        color: #20c20e;
        font-family: "Lucida Console", Monaco, monospace;
      }

      .peer-acceptable-rollback {
        fill: none;
        stroke-width: 1;
        opacity: 0.3;
      }

      .relay-rtt {
        stroke-width: 2;
      }
    </style>
  </head>

  <body>
    <canvas
      class="emscripten"
      id="canvas"
      oncontextmenu="event.preventDefault()"
      tabindex="-1"
    >
    </canvas>
    <div id="pauseMenuContainer" hidden>
      <div id="pauseMenuBorder">
        <div id="pauseMenu">
          <button id="resumeButton" onclick="resume()">
            Resume
          </button>
          <button id="quitButton" onclick="quitIfSupported()">
            Quit
          </button>
        </div>
        </div>
    </div>
    <div class="loading">
      <div class="spinner" id="spinner"></div>
      <div class="emscripten" id="status">Downloading...</div>

      <progress value="0" max="100" id="progress" hidden="1"></progress>
      <img id="QRCode" class="qrCode" src="runner.svg" alt="URL QR Code" hidden="1"></img>
      <img id="QR2Code" class="qrCode" src="runnerLocal.svg" alt="URL QR2 Code" hidden="1"></img>
    </div>

    <div class="floating-control" id="multiplayer-stats-container">
      <div class="multiplayer-stats-network" id="multiplayer-stats-network">
        <svg version="1.2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="graph" aria-labelledby="title" role="img" viewbox="-20 -10 130 140">
          <title id="title">Network stats</title>
          <g class="grid x-grid" id="xGrid">
            <line x1="0" y1="100" x2="100" y2="100"></line>

            <line x1="12.25" y1="99" x2="12.25" y2="101"></line>
            <line x1="25" y1="98" x2="25" y2="102"></line>
            <line x1="37.5" y1="99" x2="37.5" y2="101"></line>
            <line x1="50" y1="98" x2="50" y2="102"></line>
            <line x1="62.5" y1="99" x2="62.5" y2="101"></line>
            <line x1="75" y1="98" x2="75" y2="102"></line>
            <line x1="87.5" y1="99" x2="87.5" y2="101"></line>
            <line x1="100" y1="98" x2="100" y2="102"></line>
          </g>
          <g class="grid y-grid" id="yGrid">
            <line x1="0" y1="0" x2="0" y2="100"></line>

            <line x1="-2" y1="0" x2="2" y2="0"></line>
            <line x1="-1" y1="12.5" x2="1" y2="12.50"></line>
            <line x1="-2" y1="25" x2="2" y2="25"></line>
            <line x1="-1" y1="37.5" x2="1" y2="37.5"></line>
            <line x1="-2" y1="50" x2="2" y2="50"></line>
            <line x1="-1" y1="62.5" x2="1" y2="62.5"></line>
            <line x1="-2" y1="75" x2="2" y2="75"></line>
            <line x1="-1" y1="87.5" x2="1" y2="87.5"></line>
          </g>
          <g class="labels x-labels">
            <text x="0" y="110">-8</text>
            <text x="25" y="110">-4</text>
            <text x="50" y="110">0</text>
            <text x="75" y="110">4</text>
            <text x="100" y="110">8</text>
            <text x="50" y="115" class="label-title">Time shift</text>
          </g>
          <g class="labels y-labels">
            <text x="-4" y="0" alignment-baseline="middle">16</text>
            <text x="-4" y="25" alignment-baseline="middle">12</text>
            <text x="-4" y="50" alignment-baseline="middle">8</text>
            <text x="-4" y="75" alignment-baseline="middle">4</text>
            <text x="-4" y="100" alignment-baseline="middle">0</text>
            <text x="-10" y="50" class="label-title" alignment-baseline="middle">RTT</text>
          </g>

          <g id="stats-network-peers">
          </g>

          <g id="stats-network-peer-frame-delays">
          </g>

          <g id="stats-network-relay-rtt">
          </g>
        </svg>
      </div>
      <div>
        <b>Acceptable rollback frames marker:</b>
        <div>
          <button class="acceptable-rollback-button" onclick="set_acceptable_rollback(0)">Off</button>
          <button class="acceptable-rollback-button" onclick="set_acceptable_rollback(1)">+1</button>
          <button class="acceptable-rollback-button" onclick="set_acceptable_rollback(2)">+2</button>
          <button class="acceptable-rollback-button" onclick="set_acceptable_rollback(4)">+4</button>
        </div>
      </div>
      <div id="multiplayer-stats">
        [no stats available]
      </div>
    </div>

    <div class="wallpaper-container" id="wallpaper-container" style="display: none">
      <button class="output-button" onclick="toggleElement('wallpaper-config-iframe')">
        Toggle configurator
      </button>
    </div>
    <!-- The wallpaper config is displayed in an iframe to make it possible to use keyboard for entering values (it's consumed by
        the runner in the original document). -->
    <iframe class="floating-control" id="wallpaper-config-iframe" src="about:blank"></iframe>

    <div id="message-container">
      <div id="messages">
      </div>
    </div>

   <script async
     data-ad-client="ca-pub-123"
     data-ad-frequency-hint="30s"
     data-adbreak-test="on"
     src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>

   <script>
     window.adsbygoogle = window.adsbygoogle || [];
     const adBreak =  adConfig = function(o) {adsbygoogle.push(o);}
   </script>
<script>
function mergeFiles(fileParts) {
  return new Promise((resolve, reject) => {
    let buffers = [];

    function fetchPart(index) {
      if (index >= fileParts.length) {
        let mergedBlob = new Blob(buffers);
        let mergedFileUrl = URL.createObjectURL(mergedBlob);
        resolve(mergedFileUrl);
        return;
      }
      fetch(fileParts[index])
        .then((response) => response.arrayBuffer())
        .then((data) => {
          buffers.push(data);
          fetchPart(index + 1);
        })
        .catch(reject);
    }
    fetchPart(0);
  });
}

function getParts(file, start, end) {
  let parts = [];
  for (let i = start; i <= end; i++) {
    parts.push(file + ".part" + i);
  }
  return parts;
}

Promise.all([
  mergeFiles(getParts("game.unx", 1, 2)),
  mergeFiles(getParts("audiogroup2.dat", 1, 3))
]).then(([gameUnxUrl, audioGroup2Url]) => {
  window.gameUnxUrl = gameUnxUrl;
  window.audioGroup2Url = audioGroup2Url;

  const originalFetch = window.fetch;
  window.fetch = async function (...args) {
    let [url, options] = args;
    if (typeof url === 'string') {
      if (url.includes("game.unx")) {
        url = window.gameUnxUrl;
      } else if (url.includes("audiogroup2.dat")) {
        url = window.audioGroup2Url;
      }
    } else if (url instanceof Request) {
      if (url.url.includes("game.unx")) {
        url = new Request(window.gameUnxUrl, url);
      } else if (url.url.includes("audiogroup2.dat")) {
        url = new Request(window.audioGroup2Url, url);
      }
    }
    return originalFetch.call(this, url, options);
  };

  const originalOpen = XMLHttpRequest.prototype.open;
  XMLHttpRequest.prototype.open = function (method, url, ...rest) {
    if (url.includes("game.unx")) {
      url = window.gameUnxUrl;
    } else if (url.includes("audiogroup2.dat")) {
      url = window.audioGroup2Url;
    }
    return originalOpen.call(this, method, url, ...rest);
  };
  let worker = document.createElement("script");
  worker.src = "tickWorker.js";
  worker.id = "tick-worker";
  worker.type = "javascript/worker";
  document.body.appendChild(worker);

  let index = document.createElement("script");
  index.src = "index.js";
  document.body.appendChild(index);

  let runner = document.createElement("script");
  runner.src = "runner.js";
  document.body.appendChild(runner);

}).catch(error => {
  console.error("Failed to merge files:", error);
});
</script>

  </body>
</html>
